(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{167:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(31),o=a.n(s),i=(a(73),a(11)),c=a(12),l=a(14),u=a(13),m=a(15),d=(a(74),a(7)),p=a.n(d),h=a(17),v=a(3),f=(a(77),a(67)),y=a(63),g=a.n(y),b=(a(81),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isFalling:!0},a.color=function(e){switch(e){case 2:return"#7d4040";case 1:return"#527d40";case-1:return"#3a5a27";case 0:default:return"#c2e4b4"}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.color(this.props.value);return r.a.createElement("div",{className:"tile",style:{width:this.props.tileSize,height:this.props.tileSize,top:this.props.top,backgroundColor:this.props.backgroundColor?this.props.backgroundColor:"#c2e4b4",borderWidth:this.props.active||this.props.border?" 1px":0,borderColor:"black",borderStyle:"solid"}},r.a.createElement("div",{style:{margin:2,backgroundColor:this.props.backgroundColor?this.props.backgroundColor:e,width:this.props.tileSize-6,height:this.props.tileSize-6}}))}}]),t}(r.a.Component)),E=new(a(64).GraphQLClient)("https://api.graph.cool/simple/v1/cjtyw2zs55c480149tcqysrt4",{});function j(){return w.apply(this,arguments)}function w(){return(w=Object(h.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.request("\n  {\n    allUsers(orderBy:\n      score_DESC,\n      first:100\n    ){\n      score\n      id\n      name\n      createdAt\n      updatedAt\n    }\n  }\n    \n  "));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var x=function(){var e=Object(h.a)(p.a.mark(function e(t,a){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.request(" mutation createUser($name: String!, $score: Int!) {\n        createUser(\n            name: $name,\n            score: $score\n        ) {\n            id\n            name,\n            score\n        }\n}\n  ",{name:t,score:a});case 2:return n=e.sent,e.abrupt("return",n.createUser);case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),k=a(65),S=a.n(k),O=(a(84),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={users:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:t=e.sent,this.setState({users:t.allUsers});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{marginTop:15}},"Highscore Top 100",r.a.createElement("br",null),r.a.createElement("table",{className:"score-board"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Name"),r.a.createElement("td",null,"Score"),r.a.createElement("td",null,"When")),this.state.users.map(function(t){return r.a.createElement("tr",{key:t.id,className:e.props.user.id===t.id?"you":""},r.a.createElement("td",null,t.name," "),r.a.createElement("td",null,t.score),r.a.createElement("td",null,S()(t.createdAt).format("YYYY-MM-DD")))}))))}}]),t}(r.a.Component)),C=a(21),N=a(32),P=a.n(N),D=a(22),W=a.n(D),z=function(e,t,a,n,r){for(var s=0;s<4;s++)for(var o=0;o<4;o++){if(1===n[L(o,s,r)]){var i=t+s,c=a+o;c>-1&&i>-1&&(e[i][c]=1)}}return e},G=[[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],[0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0],[0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0],[0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0],[0,0,0,0,0,1,1,0,0,1,0,0,0,1,0,0],[0,0,0,0,0,1,1,0,0,0,1,0,0,0,1,0]],I=function(e,t,a,n,r){if(t>e[0].length-1||a>e.length-1)return!1;for(var s=0;s<4;s++)for(var o=0;o<4;o++){var i=L(o,s,r);if(a+s>-1&&t+o>-1&&1===n[i]&&0!==e[a+s][t+o])return!1}return!0},L=function(e,t,a){return 0===a?4*t+e:1===a?12+t-4*e:2===a?15-4*t-e:3===a?3-t+4*e:0},U=function(e){switch(e){case 1:return 100;case 2:return 300;case 3:return 800;case 4:return 1200;default:return 0}},A=function(e){switch(e){case 0:return 1;case 1:return 2;case 2:return 3;case 3:default:return 0}},H=4,M=-2,T=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).nextProjectile=function(){return Object.assign(G[Math.floor(Math.random()*G.length)],[])},a.gameloop=function(){if(a.state.isGameInProgress)if(a.state.totalProjectiles%10===0&&a.state.shouldUpdateSpeed&&(a.setState(Object(v.a)({},a.state,{speed:a.state.speed+1,shouldUpdateSpeed:!1})),clearInterval(a.interval),a.startGameLoop()),I(a.state.matrix,a.state.x,a.state.y+1,a.state.projectile,a.state.rotation))a.setState(Object(v.a)({},a.state,{y:a.state.y+1}));else if(I(a.state.matrix,H,M,a.state.nextProjectile,a.state.rotation)){a.setState(Object(v.a)({},a.state,{score:a.state.score+25,rotation:0,x:H,y:M,totalProjectiles:a.state.totalProjectiles+1,matrix:z(a.state.matrix,a.state.y,a.state.x,a.state.projectile,a.state.rotation),projectile:a.state.nextProjectile,nextProjectile:a.nextProjectile()}));for(var e=Object.assign(a.state.matrix,{}),t=[],n=0;n<e.length;n++){for(var r=e[n],s=!0,o=1;o<r.length-1;o++){r[o]<1&&(s=!1)}s&&t.push(n)}if(t.length>0){for(var i=0;i<t.length;i++){var c=t[i];e[c]=[-1,2,2,2,2,2,2,2,2,2,2,-1]}a.setState(Object(v.a)({},a.state,{matrix:e,score:a.state.score+U(t.length),shouldUpdateSpeed:!0,isGameInProgress:!1})),setTimeout(function(){if(console.log("linesToClear: ",t),t.length>0){a.setState(Object(v.a)({},a.state));for(var n=0;n<t.length;n++){for(var r=t[n];r>0;r--)e[r]=e[r-1];for(var s=[],o=0;o<a.props.lineLength;o++)0===o||o===a.props.lineLength-1?s.push(-1):s.push(0);e[0]=s}}a.setState(Object(v.a)({},a.state,{matrix:e,score:a.state.score+U(t.length),shouldUpdateSpeed:!0,isGameInProgress:!0}))},100)}}else clearInterval(a.interval),document.removeEventListener("keydown",a.listener,!1),a.setState(Object(v.a)({},a.state,{isGameOver:!0}))},a.changeName=function(e){var t=a.props.cookies,n=a.state.user;n.name=e.target.value,console.log(n),t.set("user",JSON.stringify(n),{path:"/"}),a.setState(Object(v.a)({},a.state,{user:n}))},a.saveScore=Object(h.a)(p.a.mark(function e(){var t,n,r,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.cookies,n=a.state.user.name,r=a.state.score,e.next=5,x(n,r);case 5:s=e.sent,console.log(s),delete s.score,t.set("user",JSON.stringify(s),{path:"/"}),a.setState(Object(v.a)({},a.state,{user:s,showScore:!0}));case 10:case"end":return e.stop()}},e)})),a.keyDown=function(e){if(80===e.keyCode&&a.setState(Object(v.a)({},a.state,{isGameInProgress:!a.state.isGameInProgress})),37===e.keyCode&&I(a.state.matrix,a.state.x-1,a.state.y,a.state.projectile,a.state.rotation)&&a.setState(Object(v.a)({},a.state,{x:a.state.x-1})),39===e.keyCode&&I(a.state.matrix,a.state.x+1,a.state.y,a.state.projectile,a.state.rotation)&&a.setState(Object(v.a)({},a.state,{x:a.state.x+1})),32===e.keyCode&&(I(a.state.matrix,a.state.x,a.state.y,a.state.projectile,A(a.state.rotation))?a.setState(Object(v.a)({},a.state,{rotation:A(a.state.rotation)})):I(a.state.matrix,a.state.x+1,a.state.y,a.state.projectile,A(a.state.rotation))?a.setState(Object(v.a)({},a.state,{x:a.state.x+1,rotation:A(a.state.rotation)})):I(a.state.matrix,a.state.x-1,a.state.y,a.state.projectile,A(a.state.rotation))&&a.setState(Object(v.a)({},a.state,{x:a.state.x-1,rotation:A(a.state.rotation)}))),40===e.keyCode){for(var t=a.state.matrix,n=a.state.x,r=a.state.y+1;I(t,n,r,a.state.projectile,a.state.rotation);)r+=1,console.log("while called",r);a.setState(Object(v.a)({},a.state,{y:r-1}))}},a.startGameLoop=function(){a.interval=setInterval(function(){return a.gameloop()},900-800*(1-1/a.state.speed))};for(var n=e.cookies,r=[],s=0;s<e.lines;s++){var o=[];if(s===e.lines-1)for(var c=0;c<e.lineLength;c++)o.push(-1);else for(var m=0;m<e.lineLength;m++)0===m||m===e.lineLength-1?o.push(-1):o.push(0);r.push(o)}var d=n.get("user")||{id:g()(),name:"Anonymous"};return console.log(d),a.state={user:d,score:0,totalProjectiles:1,isGameInProgress:!0,isGameOver:!1,matrix:r,x:H,y:M,rotation:0,projectile:a.nextProjectile(),nextProjectile:a.nextProjectile(),speed:1,shouldUpdateSpeed:!1,showScore:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.listener=document.addEventListener("keydown",this.keyDown,!1),this.startGameLoop()}},{key:"render",value:function(){var e=this,t=this.props.tileSize,a=this.props.lineLength*t,n=this.props.lines*t,s=JSON.parse(JSON.stringify(this.state.matrix)),o=z(s,this.state.y,this.state.x,this.state.projectile,this.state.rotation);return this.state.showScore?r.a.createElement("div",{style:{marginTop:10}},r.a.createElement(P.a,{variant:"contained",color:"primary",onClick:function(){return e.setState(Object(v.a)({},e.state,{showScore:!1}))}},"Hide score"),r.a.createElement(O,{user:this.state.user})):this.state.isGameOver?r.a.createElement("div",{style:{marginTop:10,fontSize:25}},r.a.createElement("div",null,r.a.createElement("h3",null,"Game over!")),r.a.createElement("div",null,"Your name:",r.a.createElement("input",{defaultValue:this.state.user.name,onChange:this.changeName,placeholder:"Enter your name",style:{textAlign:"center",fontSize:20,border:0,borderBottom:"1px solid",margin:20}})),r.a.createElement("div",null,"Your score: ",this.state.score),r.a.createElement("div",{style:{marginTop:15}},r.a.createElement(P.a,{variant:"contained",color:"primary",onClick:this.saveScore},"SAVE MY SCORE")),r.a.createElement("div",{style:{marginTop:15}},r.a.createElement(P.a,{variant:"contained",color:"primary",onClick:function(){return e.setState(Object(v.a)({},e.state,{showScore:!0}))}},"SHOW HIGHSCORE")),r.a.createElement("div",{style:{marginTop:15}},r.a.createElement(P.a,{variant:"contained",color:"secondary",onClick:function(){return window.location.reload()},title:"Restart"},"Restart"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:15,alignItems:"start",justifyContent:"center"}},r.a.createElement("div",{className:"tetris"},r.a.createElement("div",{className:"container",style:{height:n,width:a,minWidth:a},ref:this.container},o.map(function(e,a){return e.map(function(e,n){var s=n*t;return e>0?r.a.createElement(b,{key:a+n,top:s,value:e,tileSize:t,active:!0}):-1===e?r.a.createElement(b,{value:e,key:a+n,top:s,tileSize:t,border:!0}):r.a.createElement(b,{value:e,key:a+n,top:s,tileSize:t})})}))),r.a.createElement("div",{style:{margin:10}},r.a.createElement("div",null,"Score: ",this.state.score," "),!this.state.isGameInProgress&&"Paused ",r.a.createElement("div",null,"Speed: ",this.state.speed," "),r.a.createElement("br",null),"Next:",r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:4*t+"px",alignItems:"center",left:0,right:0,margin:"auto"}},this.state.nextProjectile.map(function(e,a){return 0===e?r.a.createElement(b,{value:e,key:a,tileSize:t,backgroundColor:"#fff"}):r.a.createElement(b,{key:a,value:e,tileSize:t,active:!0})})))),r.a.createElement("div",{className:"controls"},r.a.createElement("div",{className:"options"},r.a.createElement(W.a,{variant:"contained",color:"primary",onClick:function(){return e.keyDown({keyCode:80})}},r.a.createElement(C.a,{icon:"pause"}))),r.a.createElement("div",{className:"piece"},r.a.createElement("div",{className:"position"},r.a.createElement("div",{className:"x-scale"},r.a.createElement(W.a,{variant:"contained",color:"primary",style:{minWidth:4*t,minHeight:4*t},onClick:function(){return e.keyDown({keyCode:37})}},r.a.createElement(C.a,{icon:"chevron-left"})),r.a.createElement(W.a,{variant:"contained",color:"primary",style:{minWidth:4*t,minHeight:4*t},onClick:function(){return e.keyDown({keyCode:39})}},r.a.createElement(C.a,{icon:"chevron-right"}))),r.a.createElement("div",{className:"y-scale"},r.a.createElement(W.a,{variant:"contained",color:"primary",style:{minWidth:4*t,minHeight:4*t},onClick:function(){return e.keyDown({keyCode:40})}},r.a.createElement(C.a,{icon:"chevron-down"})))),r.a.createElement("div",{className:"change"},r.a.createElement(W.a,{variant:"contained",color:"primary",style:{minWidth:6*t,minHeight:6*t},onClick:function(){return e.keyDown({keyCode:32})}},r.a.createElement(C.a,{icon:"sync-alt"}))))))}}]),t}(r.a.Component),Y=Object(f.a)(T),J=a(9),B=a(23);J.b.add(B.b),J.b.add(B.c),J.b.add(B.a),J.b.add(B.e),J.b.add(B.d);var $=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={width:0,height:0},a.updateWindowDimensions=function(){a.setState({width:window.innerWidth,height:window.innerHeight})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){var e=Math.floor((this.state.height-.4*this.state.height)/18),t=Math.floor(this.state.width/18),a=t>=e?e:t;return r.a.createElement("div",{className:"App"},r.a.createElement(Y,{tileSize:a,lines:18,lineLength:12}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},68:function(e,t,a){e.exports=a(167)},73:function(e,t,a){},74:function(e,t,a){},77:function(e,t,a){},81:function(e,t,a){},84:function(e,t,a){}},[[68,1,2]]]);
//# sourceMappingURL=main.9ea1ff8e.chunk.js.map